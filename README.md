# smartcar-voice-key-controller-app
하드웨어 구성은 다음과 같다.크게 요약하여 보면 다음의 기술을 사용하였다.1.라즈베리파이(리눅스 쉘(서버통신) 연결,아두이노 입,출력제어,웹캠 통신)2.아두이노(자동차 바퀴제어,신호따라 동작을 분류하여 제어)3.웹캠서버4.안드로이드(Jsch를 통한 리눅스 쉘간의 통신,webview를 활용한 웹캠 연결, tts(음성 피드백),stt(speech to text)를 활용한 음성명령제어...) 나는 여기서 안드로이드의 jsch를 제외한 대부분을 맡았다. 따라서 나는 안드로이드 위주로 설명을 하고자 한다.우선 화면구성부터 보도록 하자. 1.splash화면기능은 간단하다. 메인 화면이 나오기 전까지 2초간 이화면에서 splug글자가 서서히 나타나다가 메인 화면으로 넘어간다.이 페이지에서는 다음과 같은 기능을 익혀둘 필요가 있다(1)안드로이드 애니메이션 (xml) 제어(2)스레드(안드로이드 핸들러)※스레드의(sleep)을 사용할때 매우 조심하여햐 한다. 자칫하다가는 사진에 있는 splug을 포함한 모든 뷰에도 sleep이 걸려 그냥 화면이 2초간 정지되어 아무것도 보이지 않다가 메인으로 넘어갈 수도 있으니 사용에 유의하자. 2.인트로별거 없다. ip받아서 다음 액티비티에 string 데이터로 전달한다.  3(1)방향키 제어화면(1)jsch connect버튼을 누르면 앞 엑티비티에서 받아온 ip값으로 원격 접속을 시도한다(jsch api 참조.)접속이 성공하면 tts를 활용하여 "연결작업 완료" 라고 안드로이드가 말을 하게 구현하였고, 동시에 웹켐에 접속을 하여 웹뷰에 띄워준다. (2)webView위에서 설명하였듯이 웹캠을 띄워주는 view이다. 웹캠 연결이 불안하면 404에러가 뜰수도 있다.(3)방향키onTouchListener을 이용하여 구현하였다. 각 방향키가 눌리면 라즈베리파이에 신호(앞:2 뒤:8 좌:4 우:6)를 전송하고 각 방향으로 이동한다고 안드로이드가 말한다(tts). 그리고 버튼에서 손을 떼는순간 정지 신호(정지:0)를 전송하여 작동이 멈추게 한후 "정지"라고 말한다. ※※ 커넥트가 안된상태에서 신호전송을 할 경우 예외가 발생하여 앱이 뻗는다. 예외처리를 반드시 해 주자. (4)tts작동에 대한 음성 피드백을 주는 api이다. string을 speech(음성)으로 반환 해 준다. (5)스위치아래에 방향키는 레이아웃을 따로주어 스위치가 꺼지면 방향키 레이아웃, 스위치가 켜지면 음성인식 제어 레이아웃이 나온다. 주의 할 점은 각각 전환될때 보이지 않을 레이아웃의 visibility를 "invisible"로 하면, stack상에서 위젯이 사라지지 않으므로 보이지 않아도 객체가 인식이 될 수있다. 따라서 visibility를 "GONE"으로 주도록 하자.  3(2)음성인식 제어화면(1) stt(Speech To Text): 구현 방법은 상당히 복잡하므로 미리 따로 공부를 한 후 구현하기 바란다.간단하게 설명을 하면 speechLISTENER 라는 객체에 override된 메소드인 onPartialResult,onResult 에 음성으로 내린 명령어가 arraylist 형태로 전달된다. 따라서 저 두 메소드안에서 신호를 전송하는 명령어를 넣으면 된다. 케이스는 다음과 같이 분류한다.   -명령어에 "앞"or"전진" 이라는 단어가 포함되어있음: 2를 전송,  tts"전진합니다" 실행  -명령어에 "뒤"or"후진"이라는 단어가 포함되어있음: 8을 전송,  tts"후진합니다" 실행  -명령어에 "좌"or"왼"이라는 단어가 포함되어있음:4를 전송,  tts"왼쪽으로 이동합니다" 실행  -명령어에 "오른"or"우측"이라는 단어가 포함되어있음:6을 전송, tts"오른쪽으로 이동합니다" 실행  -명령어에 "정지"or"멈춰"라는 단어가 포함: 0을 전송, tts"구동 일시정지"실행 ※주의!! onPartialResult는 음성을 모두 받을때까지 무한루프가 돌면서 메소드가 실행되므로 자칫 전송하는 명령을 여러번 보낼수가 있다. 그렇게 되면 라즈베리 파이에서 자바쉘이 예외가 발생하면서 연결이 끊어져 버릴수가 있으므로 onresult 에서만 받던지, 아님 중복검사 논리코드를 삽입하여야 한다. 나머지는 3(1)과 같음
